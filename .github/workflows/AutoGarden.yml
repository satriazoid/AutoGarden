name: AutoGarden ðŸŒ¿

on:
  schedule:
    # Berjalan otomatis setiap 12 jam sekali
    - cron: '0 */12 * * *'
  workflow_dispatch: # Tombol rahasia untuk tes manual

jobs:
  cultivate:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Gardening Loop
        run: |
          # 1. Konfigurasi identitas agar grafik GitHub menyala
          git config --global user.name "satriazoid"
          git config --global user.email "satriaalfa77@gmail.com"

          # 2. Paksa sinkronisasi dengan remote (Anti-Error Merge)
          git fetch origin main
          git reset --hard origin/main

          # 3. Menjalankan loop 10 kali
          for i in {1..10}
          do
            export TZ="Asia/Jakarta"
            
            # Memberi jeda 1 detik agar timestamp selalu berubah
            sleep 1
            
            # Menggunakan '>' untuk menimpa file (menghapus log lama)
            echo "Garden watered at: $(date)" > garden_log.txt
            
            git add garden_log.txt
            
            # Menggunakan --allow-empty agar tidak error jika file dianggap sama
            git commit --allow-empty -m "leaf: watering the garden $i/10 ðŸ’§"
          done
          
          # 4. Kirim semua perubahan sekaligus secara paksa
          git push origin main --force