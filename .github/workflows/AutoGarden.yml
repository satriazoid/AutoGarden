name: AutoGarden ğŸŒ¿

on:
  schedule:
    # Berjalan otomatis setiap 12 jam sekali
    - cron: '0 */12 * * *'
  workflow_dispatch: # Tombol rahasia untuk tes manual

jobs:
  cultivate:
    runs-on: ubuntu-latest
    permissions:
      contents: write

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Gardening Loop
        run: |
          # Konfigurasi identitas
          git config --global user.name "satriazoid"
          git config --global user.email "satriaalfa77@gmail.com"

          # SOLUSI: Paksa sinkronisasi dengan remote
          git fetch origin main
          git reset --hard origin/main

          # Menjalankan loop 10 kali
          for i in {1..10}
          do
            export TZ="Asia/Jakarta"
            # Menggunakan '>' untuk menimpa file (hapus log lama)
            echo "Garden watered at: $(date)" > garden_log.txt
            git add garden_log.txt
            git commit -m "leaf: watering the garden $i/10 ğŸ’§"
          done
          
          # Kirim perubahan
          git push origin main --force